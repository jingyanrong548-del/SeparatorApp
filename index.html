<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>气液分离器选型计算器</title>
    <link rel="stylesheet" href="/src/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>气液分离器选型计算器</h1>
            <p class="subtitle">Gas-Liquid Separator Sizing Calculator</p>
        </header>

        <!-- 类型选择器 -->
        <section class="type-selector-section">
            <div class="type-selector">
                <button id="verticalBtn" class="type-btn active">制冷立式</button>
                <button id="horizontalBtn" class="type-btn">制冷卧式</button>
                <button id="surgeDrumBtn" class="type-btn">Surge Drum 校验</button>
                <button id="steamBtn" class="type-btn">水蒸汽立式</button>
            </div>
        </section>

        <!-- 立式气液分离器内容 -->
        <div id="verticalContent" class="separator-content">
            <!-- 气液分离器示意图 -->
            <section class="diagram-section">
                <div class="diagram-container">
                    <img 
                        src="https://encrypted-tbn0.gstatic.com/licensed-image?q=tbn:ANd9GcT-yxP-vVbsG-Sk1GQ6O2WYODWIw94D1RWfOw2pItIquJKHkNeoe-Wc_cngDOgoXfuP2YbSNUFNWIerYUOzwn7cAVystGpG_jBvKNIsf-5tzA3r7UU" 
                        alt="立式气液分离器结构示意图" 
                        class="separator-diagram"
                        loading="lazy"
                    />
                    <p class="diagram-caption">制冷立式气液分离器结构示意图</p>
                </div>
            </section>

            <main class="main-content">
            <!-- 左侧：参数输入区 -->
            <section class="input-section">
                <h2>输入参数</h2>
                <div class="form-group calc-mode-group">
                    <label for="calcMode">计算模式</label>
                    <select id="calcMode" class="input-field">
                        <option value="auto">自动计算直径（选型模式）</option>
                        <option value="manual-velocity">手动输入设计气速</option>
                        <option value="manual-diameter">手动输入直径（校核模式）</option>
                    </select>
                    <small class="hint">选择计算模式以确定需要输入的参数</small>
                </div>

                <div class="form-group">
                    <label for="refrigerant">制冷剂类型</label>
                    <select id="refrigerant" class="input-field">
                        <optgroup label="低温制冷剂 (蒸发温度 < -20°C)">
                            <option value="R23">R23 (HFC-23)</option>
                            <option value="R508B">R508B (HFC-508B)</option>
                            <option value="R170">R170 (Ethane)</option>
                            <option value="R1150">R1150 (Ethylene)</option>
                        </optgroup>
                        <optgroup label="中温制冷剂 (-20°C ~ 10°C)">
                            <option value="R134a" selected>R134a (HFC-134a)</option>
                            <option value="R404A">R404A (HFC-404A)</option>
                            <option value="R407C">R407C (HFC-407C)</option>
                            <option value="R507A">R507A (HFC-507A)</option>
                            <option value="R22">R22 (HCFC-22)</option>
                            <option value="R1234ze(E)">R1234ze(E) (HFO-1234ze)</option>
                            <option value="R1234yf">R1234yf (HFO-1234yf)</option>
                            <option value="R32">R32 (HFC-32)</option>
                            <option value="R290">R290 (Propane)</option>
                            <option value="R600a">R600a (Isobutane)</option>
                            <option value="R410A">R410A (HFC-410A)</option>
                            <option value="R744">R744 (CO₂, 二氧化碳)</option>
                        </optgroup>
                        <optgroup label="高温制冷剂 (蒸发温度 > 10°C)">
                            <option value="R245fa">R245fa (HFC-245fa)</option>
                            <option value="R123">R123 (HCFC-123)</option>
                            <option value="R236fa">R236fa (HFC-236fa)</option>
                            <option value="R365mfc">R365mfc (HFC-365mfc)</option>
                            <option value="R717">R717 (Ammonia)</option>
                        </optgroup>
                    </select>
                </div>

                <div class="form-group">
                    <label for="coolingCapacity">制冷量 Q (kW)</label>
                    <input type="number" id="coolingCapacity" class="input-field" value="100" step="0.1" min="0">
                </div>

                <div class="form-group">
                    <label for="evapTemp">蒸发温度 Te (°C)</label>
                    <input type="number" id="evapTemp" class="input-field" value="5" step="0.1">
                </div>

                <div class="form-group">
                    <label for="superheat">吸气过热度 ΔT_sh (K)</label>
                    <input type="number" id="superheat" class="input-field" value="5" step="0.1" min="0">
                </div>

                <div class="form-group" id="dropletSizeGroup">
                    <label for="dropletSize">液滴直径 Dp (µm)</label>
                    <input type="number" id="dropletSize" class="input-field" value="152" step="1" min="100" max="200">
                    <small class="hint">推荐范围: 100 - 200 µm (默认 152 µm)</small>
                </div>

                <div class="form-group" id="gasVelocityGroup" style="display: none;">
                    <label for="gasVelocity">设计气速 u (m/s)</label>
                    <input type="number" id="gasVelocity" class="input-field" value="0.6" step="0.1" min="0.1" max="2.0">
                    <small class="hint">推荐范围: 0.5 - 1.0 m/s</small>
                </div>

                <div class="form-group" id="diameterInputGroup" style="display: none;">
                    <label for="diameterInput">筒身内径 D (mm)</label>
                    <input type="number" id="diameterInput" class="input-field" value="200" step="10" min="50" max="2000">
                    <small class="hint">输入标准直径或已有设备直径</small>
                </div>

                <div class="form-group" id="velocityRatioGroup">
                    <label for="velocityRatio">设计气速系数</label>
                    <input type="number" id="velocityRatio" class="input-field" value="0.75" step="0.05" min="0.5" max="0.9">
                    <small class="hint">设计气速 = 系数 × 终端速度 (推荐: 0.75 - 0.9)</small>
                </div>

                <button id="calculateBtn" class="calculate-btn">计算</button>
            </section>

            <!-- 右侧：计算结果区 -->
            <section class="result-section">
                <h2>计算结果</h2>
                <div id="status" class="status-message"></div>
                <div class="results-grid" id="resultsContainer">
                    <div class="result-item">
                        <span class="result-label">质量流量</span>
                        <span class="result-value" id="massFlow">-</span>
                        <span class="result-unit">kg/s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">进口体积流量</span>
                        <span class="result-value" id="volumeFlow">-</span>
                        <span class="result-unit">m³/s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">吸气气体密度</span>
                        <span class="result-value" id="gasDensity">-</span>
                        <span class="result-unit">kg/m³</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">筒身内径 D</span>
                        <span class="result-value" id="diameter">-</span>
                        <span class="result-unit">mm</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">筒身高度 H</span>
                        <span class="result-value" id="height">-</span>
                        <span class="result-unit">mm</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">筒内容积</span>
                        <span class="result-value" id="volume">-</span>
                        <span class="result-unit">L</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">实际气速 u</span>
                        <span class="result-value" id="actualVelocity">-</span>
                        <span class="result-unit">m/s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">终端速度 vt</span>
                        <span class="result-value" id="terminalVelocity">-</span>
                        <span class="result-unit">m/s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">液体密度</span>
                        <span class="result-value" id="liquidDensity">-</span>
                        <span class="result-unit">kg/m³</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">气体动力粘度</span>
                        <span class="result-value" id="gasViscosity">-</span>
                        <span class="result-unit">Pa·s</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">液体停留时间</span>
                        <span class="result-value" id="residenceTime">-</span>
                        <span class="result-unit">s</span>
                    </div>
                </div>
                
                <!-- 结论与建议部分 -->
                <div class="conclusion-section" id="conclusionSection" style="display: none;">
                    <h3>结论与建议</h3>
                    <div id="conclusionContent"></div>
                </div>
            </section>
            </main>
        </div>

        <!-- 卧式气液分离器内容 -->
        <div id="horizontalContent" class="separator-content" style="display: none;">
            <!-- 气液分离器示意图 -->
            <section class="diagram-section">
                <div class="diagram-container">
                    <img 
                        src="/horizontal-separator-diagram.png" 
                        alt="制冷卧式气液分离器结构示意图" 
                        class="separator-diagram"
                        loading="lazy"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                    />
                    <div style="display: none; padding: 20px; text-align: center; color: #66757f;">
                        <p>请将制冷卧式气液分离器结构示意图放置在 <code>public/horizontal-separator-diagram.png</code></p>
                    </div>
                    <p class="diagram-caption">制冷卧式气液分离器结构示意图</p>
                </div>
            </section>

            <main class="main-content">
                <!-- 左侧：参数输入区 -->
                <section class="input-section">
                    <h2>输入参数</h2>
                    <div class="form-group calc-mode-group">
                        <label for="calcModeH">计算模式</label>
                        <select id="calcModeH" class="input-field">
                            <option value="auto">自动计算直径（选型模式）</option>
                            <option value="manual-diameter">手动输入直径（校核模式）</option>
                        </select>
                        <small class="hint">选择计算模式以确定需要输入的参数</small>
                    </div>

                    <div class="form-group">
                        <label for="refrigerantH">制冷剂类型</label>
                        <select id="refrigerantH" class="input-field">
                            <optgroup label="低温制冷剂 (蒸发温度 < -20°C)">
                                <option value="R23">R23 (HFC-23)</option>
                                <option value="R508B">R508B (HFC-508B)</option>
                                <option value="R170">R170 (Ethane)</option>
                                <option value="R1150">R1150 (Ethylene)</option>
                            </optgroup>
                            <optgroup label="中温制冷剂 (-20°C ~ 10°C)">
                                <option value="R134a" selected>R134a (HFC-134a)</option>
                                <option value="R404A">R404A (HFC-404A)</option>
                                <option value="R407C">R407C (HFC-407C)</option>
                                <option value="R507A">R507A (HFC-507A)</option>
                                <option value="R22">R22 (HCFC-22)</option>
                                <option value="R1234ze(E)">R1234ze(E) (HFO-1234ze)</option>
                                <option value="R1234yf">R1234yf (HFO-1234yf)</option>
                                <option value="R32">R32 (HFC-32)</option>
                                <option value="R290">R290 (Propane)</option>
                                <option value="R600a">R600a (Isobutane)</option>
                                <option value="R410A">R410A (HFC-410A)</option>
                                <option value="R744">R744 (CO₂, 二氧化碳)</option>
                            </optgroup>
                            <optgroup label="高温制冷剂 (蒸发温度 > 10°C)">
                                <option value="R245fa">R245fa (HFC-245fa)</option>
                                <option value="R123">R123 (HCFC-123)</option>
                                <option value="R236fa">R236fa (HFC-236fa)</option>
                                <option value="R365mfc">R365mfc (HFC-365mfc)</option>
                                <option value="R717">R717 (Ammonia)</option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="coolingCapacityH">制冷量 Q (kW)</label>
                        <input type="number" id="coolingCapacityH" class="input-field" value="100" step="0.1" min="0">
                    </div>

                    <div class="form-group">
                        <label for="evapTempH">蒸发温度 Te (°C)</label>
                        <input type="number" id="evapTempH" class="input-field" value="5" step="0.1">
                    </div>

                    <div class="form-group">
                        <label for="superheatH">吸气过热度 ΔT_sh (K)</label>
                        <input type="number" id="superheatH" class="input-field" value="5" step="0.1" min="0">
                    </div>

                    <div class="form-group" id="lengthDiameterRatioGroup">
                        <label for="lengthDiameterRatio">长径比 L/D</label>
                        <input type="number" id="lengthDiameterRatio" class="input-field" value="3.0" step="0.1" min="2.0" max="6.0">
                        <small class="hint">推荐范围: 2.0 - 6.0 (默认 3.0)</small>
                    </div>

                    <div class="form-group" id="diameterInputGroupH" style="display: none;">
                        <label for="diameterInputH">筒身内径 D (mm)</label>
                        <input type="number" id="diameterInputH" class="input-field" value="200" step="10" min="50" max="2000">
                        <small class="hint">输入标准直径或已有设备直径</small>
                    </div>

                    <div class="form-group" id="targetVelocityRatioGroupH" style="display: none;">
                        <label for="targetVelocityRatioH">目标防夹带速度比值 (vh/Vre)</label>
                        <input type="number" id="targetVelocityRatioH" class="input-field" value="0.75" step="0.05" min="0.5" max="0.9">
                        <small class="hint">校核目标：实际水平气速与防夹带速度的比值（推荐: 0.6-0.8，默认 0.75）</small>
                    </div>

                    <div class="form-group">
                        <label for="liquidLevelRatio">设计液位高度比 H_liq/D</label>
                        <input type="number" id="liquidLevelRatio" class="input-field" value="0.3" step="0.05" min="0.1" max="0.5">
                        <small class="hint">推荐范围: 0.1 - 0.5 (默认 0.3，即30%液位)</small>
                    </div>

                    <div class="form-group">
                        <label for="ksValue">Souders-Brown 系数 Ks (m/s)</label>
                        <input type="number" id="ksValue" class="input-field" value="0.07" step="0.01" min="0.05" max="0.15">
                        <small class="hint">推荐范围: 0.05 - 0.15 m/s (默认 0.07 m/s)</small>
                    </div>

                    <div class="form-group">
                        <label for="velocityMultiplier">水平气速倍数 (vh/vt)</label>
                        <input type="number" id="velocityMultiplier" class="input-field" value="3.0" step="0.5" min="1.0" max="5.0">
                        <small class="hint">推荐范围: 1.0 - 5.0 (默认 3.0，即 vh = 3 × vt)</small>
                    </div>

                    <div class="form-group">
                        <label for="circulationRatio">循环倍数（液体质量流量倍数）</label>
                        <input type="number" id="circulationRatio" class="input-field" value="10" step="0.1" min="1" max="10000">
                        <small class="hint">范围: 1% - 10000% (默认 10%，普通应用: 5%-50%，虹吸循环气分: 100%-5000%+)</small>
                    </div>

                    <button id="calculateBtnH" class="calculate-btn">计算</button>
                </section>

                <!-- 右侧：计算结果区 -->
                <section class="result-section">
                    <h2>计算结果</h2>
                    <div id="statusH" class="status-message"></div>
                    
                    <!-- SVG示意图 -->
                    <div class="diagram-svg-container">
                        <svg id="horizontalDiagram" class="separator-svg" viewBox="0 0 600 300" preserveAspectRatio="xMidYMid meet">
                            <defs>
                                <!-- 蓝色渐变 - 筒身 -->
                                <linearGradient id="tankGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                                    <stop offset="50%" style="stop-color:#bbdefb;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#90caf9;stop-opacity:1" />
                                </linearGradient>
                                <!-- 液体渐变 -->
                                <linearGradient id="liquidGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#e1f5fe;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#b3e5fc;stop-opacity:1" />
                                </linearGradient>
                                <!-- 箭头标记 -->
                                <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="#1976d2"/>
                                </marker>
                                <marker id="arrowhead-gray" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="#757575"/>
                                </marker>
                                <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="#d32f2f"/>
                                </marker>
                            </defs>
                            <!-- 筒身 -->
                            <rect id="tankBody" x="80" y="80" width="440" height="140" fill="url(#tankGradient)" stroke="#1976d2" stroke-width="3" rx="8"/>
                            <!-- 液体区域 -->
                            <rect id="liquidArea" x="80" y="220" width="440" height="0" fill="url(#liquidGradient)" stroke="#0277bd" stroke-width="2" rx="8" ry="8"/>
                            <!-- 液位线 -->
                            <line id="liquidLevel" x1="80" y1="220" x2="520" y2="220" stroke="#0277bd" stroke-width="2.5" stroke-dasharray="6,4"/>
                            <!-- 气体流向箭头 -->
                            <g id="gasFlowArrows"></g>
                            <!-- 液滴沉降轨迹 -->
                            <path id="dropletPath" d="" stroke="#d32f2f" stroke-width="2" stroke-dasharray="4,3" fill="none" opacity="0.8"/>
                            <!-- 尺寸标注 - 长度 -->
                            <line id="lengthLine" x1="80" y1="250" x2="520" y2="250" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowhead)" marker-start="url(#arrowhead)"/>
                            <text id="lengthLabel" x="300" y="270" text-anchor="middle" font-size="14" fill="#1976d2" font-weight="bold">L = - mm</text>
                            <!-- 尺寸标注 - 直径 -->
                            <line id="diameterLine" x1="40" y1="80" x2="40" y2="220" stroke="#1976d2" stroke-width="2" marker-end="url(#arrowhead)" marker-start="url(#arrowhead)"/>
                            <text id="diameterLabel" x="15" y="150" text-anchor="middle" font-size="14" fill="#1976d2" font-weight="bold">D = - mm</text>
                        </svg>
                        <p class="diagram-caption">制冷卧式气液分离器结构示意图</p>
                    </div>

                    <div class="results-grid" id="resultsContainerH">
                        <div class="result-item">
                            <span class="result-label">质量流量</span>
                            <span class="result-value" id="massFlowH">-</span>
                            <span class="result-unit">kg/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">进口体积流量</span>
                            <span class="result-value" id="volumeFlowH">-</span>
                            <span class="result-unit">m³/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">气体密度</span>
                            <span class="result-value" id="gasDensityH">-</span>
                            <span class="result-unit">kg/m³</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">液体密度</span>
                            <span class="result-value" id="liquidDensityH">-</span>
                            <span class="result-unit">kg/m³</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">沉降速度 vt</span>
                            <span class="result-value" id="terminalVelocityH">-</span>
                            <span class="result-unit">m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">筒身内径 D</span>
                            <span class="result-value" id="diameterH">-</span>
                            <span class="result-unit">mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">筒身长度 L</span>
                            <span class="result-value" id="lengthH">-</span>
                            <span class="result-unit">mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">实际水平气速 vh</span>
                            <span class="result-value" id="horizontalVelocityH">-</span>
                            <span class="result-unit">m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">防夹带速度 Vre</span>
                            <span class="result-value" id="reentrainmentVelocityH">-</span>
                            <span class="result-unit">m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">液体停留时间</span>
                            <span class="result-value" id="residenceTimeH">-</span>
                            <span class="result-unit">s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">筒内容积</span>
                            <span class="result-value" id="volumeH">-</span>
                            <span class="result-unit">L</span>
                        </div>
                    </div>
                    
                    <!-- 结论与建议部分 -->
                    <div class="conclusion-section" id="conclusionSectionH" style="display: none;">
                        <h3>结论与建议</h3>
                        <div id="conclusionContentH"></div>
                    </div>
                </section>
            </main>
        </div>

        <!-- 水蒸汽立式内容 -->
        <div id="steamContent" class="separator-content" style="display: none;">
            <main class="main-content">
                <!-- 左侧：参数输入区 -->
                <section class="input-section">
                    <h2>输入参数</h2>
                    <div class="form-group">
                        <label for="inletPressure">入口压力 P_in (MPa)</label>
                        <input type="number" id="inletPressure" class="input-field" value="1.0" step="0.1" min="0.1" max="10.0">
                        <small class="hint">推荐范围: 0.1 - 10.0 MPa</small>
                    </div>

                    <div class="form-group">
                        <label for="inletDryness">入口干度 x_in</label>
                        <input type="number" id="inletDryness" class="input-field" value="0.95" step="0.01" min="0.0" max="1.0">
                        <small class="hint">范围: 0.0 (饱和液体) - 1.0 (饱和蒸汽)</small>
                    </div>

                    <div class="form-group">
                        <label for="massFlowRate">总质量流量 m_total (kg/h)</label>
                        <input type="number" id="massFlowRate" class="input-field" value="1000" step="10" min="1">
                        <small class="hint">入口总质量流量</small>
                    </div>

                    <div class="form-group">
                        <label for="separationEfficiency">目标分离效率 (%)</label>
                        <input type="number" id="separationEfficiency" class="input-field" value="99.5" step="0.1" min="90" max="99.99">
                        <small class="hint">推荐范围: 95% - 99.9% (默认 99.5%)</small>
                    </div>

                    <div class="form-group">
                        <label for="kFactor">Souders-Brown 系数 K</label>
                        <input type="number" id="kFactor" class="input-field" value="0.15" step="0.01" min="0.05" max="0.3">
                        <small class="hint">推荐范围: 0.10 - 0.20 (默认 0.15，适用于丝网除沫器)</small>
                        <div id="meshSpecInfo" style="margin-top: 10px; padding: 12px; background: #e3f2fd; border-radius: 6px; border-left: 4px solid #1976d2; display: none;">
                            <div style="font-weight: 600; color: #1976d2; margin-bottom: 8px;">推荐不锈钢丝网规格：</div>
                            <div id="meshSpecDetails" style="font-size: 0.9rem; color: #424242; line-height: 1.6;"></div>
                        </div>
                    </div>

                    <button id="calculateBtnSteam" class="calculate-btn">计算</button>
                </section>

                <!-- 右侧：计算结果区 -->
                <section class="result-section">
                    <h2>计算结果</h2>
                    <div id="statusSteam" class="status-message"></div>
                    
                    <!-- SVG示意图 -->
                    <div class="diagram-svg-container">
                        <svg id="steamDiagram" class="separator-svg" viewBox="0 0 400 500" preserveAspectRatio="xMidYMid meet">
                            <defs>
                                <!-- 容器渐变 -->
                                <linearGradient id="steamTankGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
                                    <stop offset="50%" style="stop-color:#bbdefb;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#90caf9;stop-opacity:1" />
                                </linearGradient>
                                <!-- 液体渐变 -->
                                <linearGradient id="steamLiquidGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#e1f5fe;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#b3e5fc;stop-opacity:1" />
                                </linearGradient>
                                <!-- 蒸汽渐变 -->
                                <linearGradient id="steamVaporGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#fff3e0;stop-opacity:0.3" />
                                    <stop offset="100%" style="stop-color:#ffe0b2;stop-opacity:0.5" />
                                </linearGradient>
                                <!-- 箭头标记 -->
                                <marker id="steamArrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                    <polygon points="0 0, 10 3, 0 6" fill="#1976d2"/>
                                </marker>
                            </defs>
                            <!-- 容器主体 -->
                            <rect id="steamTankBody" x="150" y="50" width="100" height="400" fill="url(#steamTankGradient)" stroke="#1976d2" stroke-width="3" rx="5"/>
                            <!-- 液体区域 -->
                            <rect id="steamLiquidArea" x="150" y="400" width="100" height="0" fill="url(#steamLiquidGradient)" stroke="#0277bd" stroke-width="2" rx="5"/>
                            <!-- 液位线 -->
                            <line id="steamLiquidLevel" x1="150" y1="400" x2="250" y2="400" stroke="#0277bd" stroke-width="2.5" stroke-dasharray="6,4"/>
                            <!-- 不锈钢丝网区域（位于容器上部，蒸汽出口下方） -->
                            <rect id="steamMeshPad" x="145" y="120" width="110" height="15" fill="#ff9800" fill-opacity="0.3" stroke="#ff6f00" stroke-width="2" stroke-dasharray="3,2"/>
                            <text x="200" y="132" text-anchor="middle" font-size="11" fill="#e65100" font-weight="bold">不锈钢丝网</text>
                            <!-- 入口管道（位于丝网下方） -->
                            <line id="steamInletLine" x1="200" y1="200" x2="200" y2="135" stroke="#1976d2" stroke-width="4"/>
                            <polygon id="steamInletArrow" points="195,145 200,135 205,145" fill="#1976d2"/>
                            <text x="200" y="220" text-anchor="middle" font-size="12" fill="#1976d2" font-weight="bold">入口</text>
                            <!-- 蒸汽出口（位于丝网上方） -->
                            <line x1="250" y1="100" x2="280" y2="100" stroke="#1976d2" stroke-width="4"/>
                            <polygon points="275,95 280,100 275,105" fill="#1976d2"/>
                            <text x="290" y="105" font-size="12" fill="#1976d2" font-weight="bold">干蒸汽</text>
                            <!-- 液体出口 -->
                            <line x1="200" y1="450" x2="200" y2="470" stroke="#0277bd" stroke-width="4"/>
                            <polygon points="195,465 200,470 205,465" fill="#0277bd"/>
                            <text x="200" y="485" text-anchor="middle" font-size="12" fill="#0277bd" font-weight="bold">液体出口</text>
                            <!-- 尺寸标注 - 直径（水平标注，更清晰） -->
                            <line id="steamDiameterLine" x1="150" y1="480" x2="250" y2="480" stroke="#1976d2" stroke-width="2" marker-end="url(#steamArrowhead)" marker-start="url(#steamArrowhead)"/>
                            <text id="steamDiameterLabel" x="200" y="500" text-anchor="middle" font-size="12" fill="#1976d2" font-weight="bold">内径 D = - mm</text>
                            <!-- 气分高度标注 -->
                            <line id="steamHeightLine" x1="260" y1="50" x2="260" y2="450" stroke="#2e7d32" stroke-width="2" marker-end="url(#steamArrowhead)" marker-start="url(#steamArrowhead)"/>
                            <text id="steamHeightLabel" x="275" y="250" text-anchor="middle" font-size="12" fill="#2e7d32" font-weight="bold" transform="rotate(-90 275 250)">推荐高度 H = - mm</text>
                            <!-- 丝网位置标注 -->
                            <line id="steamMeshLine" x1="100" y1="127.5" x2="145" y2="127.5" stroke="#ff6f00" stroke-width="2" stroke-dasharray="4,2"/>
                            <text x="80" y="132" text-anchor="middle" font-size="11" fill="#e65100" font-weight="bold">丝网位置</text>
                        </svg>
                        <p class="diagram-caption">水蒸汽立式结构示意图</p>
                    </div>

                    <div class="results-grid" id="resultsContainerSteam">
                        <div class="result-item">
                            <span class="result-label">饱和温度 T_sat</span>
                            <span class="result-value" id="saturationTemp">-</span>
                            <span class="result-unit">°C</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">进口体积流量</span>
                            <span class="result-value" id="volumeFlowSteam">-</span>
                            <span class="result-unit">m³/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">液体密度 ρ_l</span>
                            <span class="result-value" id="liquidDensitySteam">-</span>
                            <span class="result-unit">kg/m³</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">蒸汽密度 ρ_v</span>
                            <span class="result-value" id="vaporDensitySteam">-</span>
                            <span class="result-unit">kg/m³</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">分离后液体流量</span>
                            <span class="result-value" id="separatedLiquidFlow">-</span>
                            <span class="result-unit">kg/h</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">干蒸汽流量</span>
                            <span class="result-value" id="drySteamFlow">-</span>
                            <span class="result-unit">kg/h</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">实际气速 v</span>
                            <span class="result-value" id="actualVelocitySteam">-</span>
                            <span class="result-unit">m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">最大允许气速 v_max</span>
                            <span class="result-value" id="maxVelocity">-</span>
                            <span class="result-unit">m/s</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">推荐容器直径 D</span>
                            <span class="result-value" id="vesselDiameter">-</span>
                            <span class="result-unit">mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">推荐气分高度 H</span>
                            <span class="result-value" id="vesselHeight">-</span>
                            <span class="result-unit">mm</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">最小流通面积</span>
                            <span class="result-value" id="minArea">-</span>
                            <span class="result-unit">m²</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">液体停留时间</span>
                            <span class="result-value" id="residenceTimeSteam">-</span>
                            <span class="result-unit">s</span>
                        </div>
                    </div>
                    
                    <!-- 结论与建议部分 -->
                    <div class="conclusion-section" id="conclusionSectionSteam" style="display: none;">
                        <h3>结论与建议</h3>
                        <div id="conclusionContentSteam"></div>
                    </div>
                </section>
            </main>
        </div>

        <!-- Surge Drum 校验计算内容 -->
        <div id="surgeDrumContent" class="separator-content module-surge-drum-verify" style="display: none;">
            <main class="main-content">
                <!-- 左侧：设置与计算区 -->
                <section class="panel-settings input-section">
                    <h2>Surge Drum 校验输入</h2>
                    <form class="calculation-form">
                        <!-- 计算模式选择 -->
                        <div class="form-group calc-mode-group">
                            <label for="surgeDrumCalcMode">计算模式</label>
                            <select id="surgeDrumCalcMode" class="input-field">
                                <option value="mass-flow">直接输入质量流量</option>
                                <option value="cooling-capacity">从制冷量计算</option>
                            </select>
                            <small class="hint">选择计算模式以确定需要输入的参数</small>
                        </div>

                        <!-- 分组 1：设备几何尺寸 -->
                        <div class="form-group-group">
                            <h3 class="form-group-title">设备几何尺寸 (Geometry)</h3>
                            <div class="form-group">
                                <label for="surgeDrumD">筒体内径 D (mm)</label>
                                <input type="number" id="surgeDrumD" class="input-field" step="10" min="50" placeholder="例如: 1200" value="1200" required>
                            </div>
                            <div class="form-group">
                                <label for="surgeDrumL">筒体直段长度 L (mm)</label>
                                <input type="number" id="surgeDrumL" class="input-field" step="10" min="100" placeholder="例如: 3000" value="3000" required>
                                <small class="hint">输入实际长度，系统将计算最小长度要求并校核是否满足分离要求</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumInletVelocity">带液气体入口管流速 (m/s)</label>
                                <input type="number" id="surgeDrumInletVelocity" class="input-field" step="0.1" min="1" max="20" placeholder="例如: 5" value="5">
                                <small class="hint">推荐范围: 3-8 m/s (默认 5 m/s)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumInletCount">入口管数量</label>
                                <input type="number" id="surgeDrumInletCount" class="input-field" step="1" min="1" max="10" placeholder="例如: 1" value="1" required>
                                <small class="hint">带液气体入口管数量</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumLiquidVelocity">下液管流速 (m/s)</label>
                                <input type="number" id="surgeDrumLiquidVelocity" class="input-field" step="0.1" min="0.1" max="2" placeholder="例如: 0.5" value="0.5">
                                <small class="hint">推荐范围: 0.3-1.0 m/s (默认 0.5 m/s)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumLiquidCount">下液管数量</label>
                                <input type="number" id="surgeDrumLiquidCount" class="input-field" step="1" min="1" max="10" placeholder="例如: 1" value="1" required>
                                <small class="hint">下液管数量（默认 1）</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumOutletVelocity">出气管流速 (m/s)</label>
                                <input type="number" id="surgeDrumOutletVelocity" class="input-field" step="0.5" min="5" max="30" placeholder="例如: 10" value="10">
                                <small class="hint">推荐范围: 8-15 m/s (默认 10 m/s)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumOutletCount">出气管数量</label>
                                <input type="number" id="surgeDrumOutletCount" class="input-field" step="1" min="1" max="10" placeholder="例如: 1" value="1" required>
                                <small class="hint">出气管数量（默认 1）</small>
                            </div>
                        </div>

                        <!-- 分组 2：当前状态 -->
                        <div class="form-group-group">
                            <h3 class="form-group-title">当前状态 (Status)</h3>
                            <div class="form-group">
                                <label for="surgeDrumLevel">当前液位高度百分比 Liquid Level (%)</label>
                                <input type="number" id="surgeDrumLevel" class="input-field" step="1" min="0" max="100" placeholder="例如: 50 (代表中心液位)" value="50" required>
                                <small class="hint">输入范围: 0-100 (例如 50 代表中心液位)</small>
                            </div>
                        </div>

                        <!-- 分组 3：工况参数 -->
                        <div class="form-group-group">
                            <h3 class="form-group-title">工况参数 (Operating Conditions)</h3>
                            <div class="form-group">
                                <label for="surgeDrumRefrigerant">制冷剂 (Refrigerant)</label>
                                <select id="surgeDrumRefrigerant" class="input-field" required>
                                    <optgroup label="低温制冷剂 (蒸发温度 < -20°C)">
                                        <option value="R23">R23 (HFC-23)</option>
                                        <option value="R508B">R508B (HFC-508B)</option>
                                        <option value="R170">R170 (Ethane)</option>
                                        <option value="R1150">R1150 (Ethylene)</option>
                                    </optgroup>
                                    <optgroup label="中温制冷剂 (-20°C ~ 10°C)">
                                        <option value="R134a" selected>R134a (HFC-134a)</option>
                                        <option value="R404A">R404A (HFC-404A)</option>
                                        <option value="R407C">R407C (HFC-407C)</option>
                                        <option value="R507A">R507A (HFC-507A)</option>
                                        <option value="R22">R22 (HCFC-22)</option>
                                        <option value="R1234ze(E)">R1234ze(E) (HFO-1234ze)</option>
                                        <option value="R1234yf">R1234yf (HFO-1234yf)</option>
                                        <option value="R32">R32 (HFC-32)</option>
                                        <option value="R290">R290 (Propane)</option>
                                        <option value="R600a">R600a (Isobutane)</option>
                                        <option value="R410A">R410A (HFC-410A)</option>
                                        <option value="R744">R744 (CO₂, 二氧化碳)</option>
                                    </optgroup>
                                    <optgroup label="高温制冷剂 (蒸发温度 > 10°C)">
                                        <option value="R245fa">R245fa (HFC-245fa)</option>
                                        <option value="R123">R123 (HCFC-123)</option>
                                        <option value="R236fa">R236fa (HFC-236fa)</option>
                                        <option value="R365mfc">R365mfc (HFC-365mfc)</option>
                                        <option value="R717">R717 (Ammonia)</option>
                                    </optgroup>
                                </select>
                            </div>
                            
                            <!-- 制冷量模式输入 -->
                            <div id="surgeDrumCoolingCapacityGroup" class="form-group" style="display: none;">
                                <label for="surgeDrumCoolingCapacity">制冷量 Q (kW)</label>
                                <input type="number" id="surgeDrumCoolingCapacity" class="input-field" step="0.1" min="0" placeholder="例如: 100" value="100">
                            </div>
                            <div id="surgeDrumSuperheatGroup" class="form-group" style="display: none;">
                                <label for="surgeDrumSuperheat">吸气过热度 ΔT_sh (K)</label>
                                <input type="number" id="surgeDrumSuperheat" class="input-field" step="0.1" min="0" placeholder="例如: 5" value="5">
                                <small class="hint">推荐范围: 0 - 10 K</small>
                            </div>
                            
                            <!-- 质量流量模式输入 -->
                            <div id="surgeDrumMassFlowGroup" class="form-group">
                                <label for="surgeDrumMassFlow">总入口质量流量 m_dot_total (kg/h)</label>
                                <input type="number" id="surgeDrumMassFlow" class="input-field" step="10" min="0" placeholder="例如: 5000" value="5000">
                            </div>
                            
                            <!-- 蒸发温度（两种模式都需要） -->
                            <div class="form-group">
                                <label for="surgeDrumEvapTemp">蒸发温度 Te (°C)</label>
                                <input type="number" id="surgeDrumEvapTemp" class="input-field" step="0.1" placeholder="例如: -10" value="-10" required>
                                <small class="hint">用于计算液体密度和物性参数。对于 Surge Drum，蒸发温度即为饱和温度。</small>
                            </div>
                            <div class="form-group">
                                <label for="surgeDrumXin">入口干度 x_in</label>
                                <input type="number" id="surgeDrumXin" class="input-field" step="0.01" min="0" max="1" placeholder="例如: 0.2" value="0.2" required>
                                <small class="hint">范围: 0.0 (饱和液体) - 1.0 (饱和蒸汽)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumXoutRequired">出口干度要求 x_out_required</label>
                                <input type="number" id="surgeDrumXoutRequired" class="input-field" step="0.01" min="0" max="1" placeholder="例如: 0.95" value="0.95">
                                <small class="hint">范围: 0.0 - 1.0 (默认 0.95，即95%干度要求。如果实际出口干度达不到此要求，将报警)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumKs">Souders-Brown 系数 Ks (m/s)</label>
                                <input type="number" id="surgeDrumKs" class="input-field" step="0.01" min="0.05" max="0.15" placeholder="例如: 0.07" value="0.07">
                                <small class="hint">推荐范围: 0.05 - 0.15 m/s (默认 0.07 m/s，用于计算沉降速度)</small>
                            </div>
                            
                            <div class="form-group">
                                <label for="surgeDrumVre">防夹带速度 Vre (m/s)</label>
                                <input type="text" id="surgeDrumVre" class="input-field" readonly="readonly" style="background-color: #f5f5f5; cursor: not-allowed;" value="-">
                                <small class="hint">计算后显示防夹带速度，用于评估水平气速是否安全（vh &lt; Vre）</small>
                            </div>
                        </div>

                        <!-- 分组 4：不锈钢丝网配置 -->
                        <div class="form-group-group">
                            <h3 class="form-group-title">不锈钢丝网配置 (Wire Mesh Demister)</h3>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="surgeDrumUseMesh" class="input-checkbox" checked>
                                    默认安装不锈钢丝网除沫器
                                </label>
                                <small class="hint">建议在气体出口处安装不锈钢丝网以提高分离效果</small>
                            </div>
                            
                            <div id="surgeDrumMeshSpecGroup">
                                <div class="form-group">
                                    <label for="surgeDrumMeshMesh">丝网目数 (Mesh)</label>
                                    <select id="surgeDrumMeshMesh" class="input-field">
                                        <option value="100">100目/英寸 (细密，高效分离)</option>
                                        <option value="80" selected>80目/英寸 (推荐)</option>
                                        <option value="60">60目/英寸 (标准)</option>
                                        <option value="50">50目/英寸 (粗疏)</option>
                                        <option value="40">40目/英寸 (最粗)</option>
                                    </select>
                                    <small class="hint">目数越高，分离效果越好，但压降也越大</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="surgeDrumMeshThickness">丝网厚度 (mm)</label>
                                    <input type="number" id="surgeDrumMeshThickness" class="input-field" step="10" min="50" max="200" placeholder="例如: 100" value="100">
                                    <small class="hint">推荐范围: 100-150 mm (默认 100 mm)</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="surgeDrumMeshMaterial">丝网材质</label>
                                    <select id="surgeDrumMeshMaterial" class="input-field">
                                        <option value="304" selected>304 不锈钢 (标准)</option>
                                        <option value="316">316 不锈钢 (耐腐蚀，推荐用于特殊工况)</option>
                                        <option value="316L">316L 不锈钢 (超低碳，耐腐蚀性更好)</option>
                                    </select>
                                    <small class="hint">根据工况选择合适的材质</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="surgeDrumMeshWireDiameter">丝径 (mm)</label>
                                    <input type="number" id="surgeDrumMeshWireDiameter" class="input-field" step="0.01" min="0.1" max="0.5" placeholder="例如: 0.2" value="0.2">
                                    <small class="hint">推荐范围: 0.15-0.3 mm (默认 0.2 mm)</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="surgeDrumMeshEfficiency">分离效率 (%)</label>
                                    <input type="number" id="surgeDrumMeshEfficiency" class="input-field" step="0.1" min="90" max="99.9" placeholder="例如: 99.5" value="99.5">
                                    <small class="hint">丝网除沫器的分离效率，用于计算出口干度 (推荐: 99.0-99.9%)</small>
                                </div>
                            </div>
                        </div>

                        <button type="button" id="calculateSurgeDrumBtn" class="calculate-btn btn-calculate">开始校验计算</button>
                    </form>

                    <!-- 结果显示区 -->
                    <div id="surgeDrumResults" class="results-container" style="display: none;"></div>
                </section>

                <!-- 右侧：图示区 -->
                <section class="panel-diagram result-section">
                    <div class="diagram-container">
                        <img 
                            src="/surge-drum-diagram.png" 
                            alt="卧式 Surge Drum 原理图" 
                            class="separator-diagram"
                            loading="lazy"
                            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                        />
                        <div style="display: none; padding: 20px; text-align: center; color: #66757f;">
                            <p>请将卧式 Surge Drum 原理图放置在 <code>public/surge-drum-diagram.png</code></p>
                        </div>
                        <p class="diagram-caption">图示：卧式气液分离器结构及液位示意</p>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- 加载应用代码 -->
    <script type="module" src="/src/script.js"></script>
</body>
</html>

